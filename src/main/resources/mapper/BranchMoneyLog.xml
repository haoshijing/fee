<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.yingliguoji.fee.dao.BranchMoneyLogDao">

    <sql id="tableName">
        branch_money_log
    </sql>
    <!-- 插入一条记录 -->

    <insert id="insert" parameterType="com.yingliguoji.fee.po.BranchMoneyLogPo">

        insert into <include refid="tableName"/>
        (
        branchId,
        money,
        classifyId,
        createTime
        )

        VALUES (

        #{branchId},
        #{money},
        #{classifyId},
        #{createTime}
        )

    </insert>


    <select id="querySum" resultType="java.math.BigDecimal">
        select COALESCE(  sum(reAmount),0)
        from <include refid="tableName"/>

        <if test = "branchId != null">
            AND branchId = #{branchId}
        </if>
        <if test = "classifyId != null">
          AND classifyId = #{classifyId}
        </if>

        <if test = "start != null">
            AND createTime >= #{start}
        </if>

        <if test = "end != null">
            AND createTime <![CDATA[ <= ]]> #{end}
        </if>
    </select>

</mapper>